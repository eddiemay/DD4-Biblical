<section class="grid_12">
  <div class="block-border">
    <div class="block-content">
      <h1>READ THE WORD</h1>
      <div class="block-content form">
        <a href="" data-ng-if="appCtrl.isUserLoggedIn()" data-ng-click="$ctrl.view = $ctrl.views.READ">
          <img src="images/icons/web-app/32/Search.png" alt="Read the word">
        </a>
        <a href="" data-ng-if="appCtrl.isUserLoggedIn()" data-ng-click="$ctrl.view = $ctrl.views.SEARCH_AND_REPLACE">
          <img src="images/icons/web-app/32/Modify.png" alt="Search and replace Word">
        </a>
        <a href="" data-ng-if="appCtrl.isUserLoggedIn()"  data-ng-click="$ctrl.showUpload()">
          <img src="images/icons/web-app/32/Load.png" alt="Upload">
        </a>
        <fieldset data-ng-show="$ctrl.view == $ctrl.views.READ">
          <div class="columns">
            <div class="colx3-left-double">
              <label><button data-ng-click="$ctrl.reference.shown=true">Book</button></label>
              <input type="text" data-ng-model="$ctrl.reference.value" class="full-width" data-on-enter="$ctrl.getOrSearch()">
            </div>
            <div class="colx3-right">
              <label>Version</label>
              <select data-ng-model="$ctrl.globalData.scriptureVersion" data-ng-change="$ctrl.getOrSearch()"
                      data-ng-options="version for version in $ctrl.globalData.scriptureVersions"></select>
              <label>Language</label>
              <select data-ng-model="$ctrl.globalData.language" data-ng-change="$ctrl.getOrSearch()"
                      data-ng-options="language.code as language.name for language in $ctrl.globalData.languages"></select>
              <button data-ng-click="$ctrl.getOrSearch()">Show</button>
            </div>
          </div>
        </fieldset>
        <fieldset data-ng-show="$ctrl.view == $ctrl.views.SEARCH_AND_REPLACE">
          <div class="columns">
            <div class="colx3-left">
              <label>Phrase</label>
              <input type="text" data-ng-model="$ctrl.phrase" class="full-width" data-on-enter="$ctrl.searchAndReplace(true)">
            </div>
            <div class="colx3-center">
              <label>Replacement</label>
              <input type="text" data-ng-model="$ctrl.replacement" class="full-width" data-on-enter="$ctrl.searchAndReplace(true)">
            </div>
            <div class="colx3-right">
              <label>Filter</label>
              <input type="text" data-ng-model="$ctrl.filter" class="full-width" data-on-enter="$ctrl.searchAndReplace(true)">
              <button data-ng-click="$ctrl.searchAndReplace(true)">Preview</button>
              <button data-ng-show="$ctrl.previewShown" data-ng-click="$ctrl.searchAndReplace(false)">Replace</button>
            </div>
          </div>
        </fieldset>
        <fieldset data-ng-show="$ctrl.view == $ctrl.views.UPLOAD">
          <div class="columns">
            <div class="colx3-left">
              <label>Version</label>
              <input type="text" data-ng-model="$ctrl.uploadVersion" class="full-width" data-on-enter="$ctrl.searchAndReplace(true)">
            </div>
            <div class="colx3-center">
              <label>Book</label>
              <select data-ng-model="$ctrl.uploadBook"
                      data-ng-options="book.name for book in $ctrl.allBooks"></select>
            </div>
            <div class="colx3-right">
              <label>Chapter</label>
              <select data-ng-model="$ctrl.uploadChapter"
                      data-ng-options="chapter.number as chapter.number for chapter in $ctrl.uploadBook.chapters"></select>
            </div>
          </div>
          <label>Scripture Text</label>
          <textarea data-ng-model="$ctrl.uploadText" class="full-width" style="height: 300px"></textarea>
          <button data-ng-click="$ctrl.uploadScripture(true)">Preview</button>
          <button data-ng-show="$ctrl.previewShown" data-ng-click="$ctrl.uploadScripture(false)">Upload</button>
          </div>
        </fieldset>
      </div>
      <div class="block-content form">
        <!-- a data-ng-show="$ctrl.prevChapter" href="" title="Previous Chapter" style="float: left; top: 50%;"
           data-ng-click="$ctrl.setReference($ctrl.prevChapter)">
          <img src="images/chevron-left.png" width="18" height="26">
        </a>
        <a data-ng-show="$ctrl.nextChapter"  href="" title="Next Chapter" style="float: right; top: 50%;"
           data-ng-click="$ctrl.setReference($ctrl.nextChapter)">
          <img src="images/chevron.png" width="18" height="26">
        </a -->
        <div data-ng-show="!$ctrl.searchShown">
          <p data-ng-repeat="script in $ctrl.scriptures" dir="{{script.dir}}">
            <span data-ng-show="script.showChapter">
              <a href="" data-ng-click="$ctrl.showScripture(script.version, script.book, script.chapter)">
                {{script.book}} {{script.chapter}}</a>:</span><a href="" data-ng-click="$ctrl.showScripture(script.version, script.book, script.chapter, script.verse)">{{script.verse}}</a>
            {{script.text}}
          </p>
        </div>
        <div data-ng-show="$ctrl.searchShown && $ctrl.searchResult">
          <h2>Search Results: {{$ctrl.searchResult.start}} to {{$ctrl.searchResult.end}} of {{$ctrl.searchResult.totalSize}}</h2>
          <p data-ng-repeat="group in $ctrl.searchResult.grouped">
            <a href="" data-ng-click="$ctrl.showScripture(group.version, group.book, group.chapter)">
              {{group.book}} {{group.chapter}}</a>:<a href="" data-ng-click="$ctrl.showScripture(group.version, group.book, group.chapter, group.verse)">{{group.verse}}</a>
            <span class="verse" data-ng-repeat="result in group.items">
              <br>
              (<a href="" data-ng-click="$ctrl.showScripture(result.version, result.book, result.chapter)">{{result.version}}</a>)
              {{result.text}}
            </span>
          </p>
          <fieldset>
            <span data-ng-repeat="page in $ctrl.searchResult.pages">
              <button data-ng-click="$ctrl.getOrSearch(page)" data-ng-disabled="page == $ctrl.searchResult.pageToken">{{page}}</button>
            </span>
          </fieldset>
        </div>
      </div>
      <div class="columns">
        <div class="colx2-left">
          <button data-ng-show="$ctrl.prevChapter" data-ng-click="$ctrl.setReference($ctrl.prevChapter)">Previous Chapter</button>
        </div>
        <div class="colx2-right">
          <button data-ng-show="$ctrl.nextChapter" data-ng-click="$ctrl.setReference($ctrl.nextChapter)">Next Chapter</button>
        </div>
      </div>
    </div>
  </div>
  <scripture-selector data-ng-if="$ctrl.reference.shown" data-reference="$ctrl.reference"></scripture-selector>
</section>